<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="node_modules/semantic-ui-css/semantic.min.css">
    <link rel="stylesheet" type="text/css" href="node_modules/semantic-ui-css/semantic.css">
    <link rel="stylesheet" href="css/estateDetails.css">
    <link rel="stylesheet" href="css/slideshow.css">
      <link rel="stylesheet" href="css/addProperty.css">

    <link href="css/jquery-ui-1.10.1.css" rel="stylesheet">
  	<link href="css/nigran.datepicker.css" rel="stylesheet">

    <script
      src="https://code.jquery.com/jquery-3.1.1.min.js"
      integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
      crossorigin="anonymous"></script>
    <script src="node_modules/semantic-ui-css/semantic.min.js"></script>
    <script src="node_modules/semantic-ui-css/semantic.js"></script>
    <script src="js/locations.js"></script>
    <script src="js/slideshow.js"></script>

    <script src="js/locations.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.jquery.min.js"></script>
    <link href="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.min.css" rel="stylesheet"/>

    <style>
  		input { /*for the datepicker*/
  			font-size: 1em;
  		}
  	</style>

    <link rel="icon" type="image/png" href="images/place-finder.png">
    <title>PerF</title>
  </head>
  <body style="background-color: lightblue;">

    <div id="topAddProperty" class="ui massive blue menu" >
      <a href="./homePage.html">
        <img class="ui mini image" style="position:absolute;left: 20%; top:5px;" src="images/place-finder.png">
      </a>
        <a>
            <img class="ui medium image" style="position:absolute;margin-left: 23%;" src="images/logo.png">
        </a>

      <div id="addPropertyInAddProperty" >
        <button class="ui inverted blue button" onclick="document.getElementById('addPropModal').style.display='block'">Add property</button>
      </div>
      <div id="signupAddProperty">
        <button class="ui inverted blue button" onclick="document.getElementById('id01').style.display='block'">Sign up</button>
      </div>
      <div id="loginAddProperty">
        <button class="ui inverted blue button" onclick="document.getElementById('id02').style.display='block'">Log-in</button>
      </div>
    </div>

    <script>
          $(function(){
              var stickyHeaderTopAddProperty = $('#topAddProperty').offset().top;

              $(window).scroll(function(){
                          if( $(window).scrollTop() > stickyHeaderTopAddProperty ) {
                                  $('#topAddProperty').css({position: 'fixed', top: '0px'});
                                  $('#topAddProperty').css('width','100%');
                                  $('#topAddProperty').css('display', 'block');
                                  $('#topAddProperty').css('z-index','999999');
                          } else {
                                  $('#topAddProperty').css({position: 'static', top: '0px'});
                          }
                  });
        });
    </script>

  <div class="ui raised container segment" style="position:absolute;width:60%;height: 130%; left:10%; right:10%; background: #f1f1f2;z-index: 9;">
      <div class="ui borderless blue inverted menu" style="margin-top:-1.5%;margin-left:-1.5%;margin-right:-1.5%;">
        <div class="item">
            <button class="ui inverted white button" type="submit" onclick="getBack()"><i class="chevron circle left icon"></i>Back to search</button>

          <script>
            function getBack(){
              window.location = "./searchCity.html";
            }
          </script>
        </div>
      </div>

      <div>
        <div>
          <form class="ui form">
              <h4 class="ui dividing header">Add property</h4>

              <div class="field">
                  <div class="fields">
                      <div class="four wide field">
                          <label>Category:</label>
                          <select id="category-select">
                              <option value="" disabled selected>Choose</option>
                              <option value="1">House</option>
                              <option value="2">Appartement</option>
                              <option value="3">Comercial space</option>
                          </select>
                      </div>
                      <div class="four wide field">
                          <label>Rooms:</label>
                          <select id="rooms-select">
                              <option value="" disabled selected>Choose</option>
                              <option value="1">1 room</option>
                              <option value="2">2 rooms</option>
                              <option value="3">3 rooms</option>
                              <option value="4">4 or more rooms</option>
                          </select>
                      </div>
                  </div>
              </div>
              <div class="field">
                  <div class="ui form">
                          <label >Transaction type:</label>
                          <div class="field">
                              <div class="ui radio checkbox">
                                  <input id="transaction-type-rent-input" name="fruit" tabindex="0" type="radio" onChange={setCheckbox('transaction-type-rent-input')} unchecked={}>
                                  <label>Rent</label>
                              </div>
                          </div>
                          <div class="field">
                              <div class="ui radio checkbox">
                                  <input id="transaction-type-sale-input" name="fruit" tabindex="0" type="radio" onChange={setCheckbox('transaction-type-sale-input')} unchecked={}>
                                  <label>Sale</label>
                              </div>
                          </div>
                  </div>
              </div>
              <script>

              function setCheckbox(id) {
				isForRent=0;
				isForSale=0;
                if(document.getElementById(id).checked) {
                  if(id==="transaction-type-sale-input")
                    isForSale=1;
                  if(id==="transaction-type-rent-input")
                      isForRent=1;
                }
              }

			  function setNegociable(id) {
				isNegociable=0;
                if(document.getElementById(id).checked) {
                  if(id==="is-negociable-input")
                    isNegociable=1;
                }
              }

              </script>
              <div class="two wide fields">
                  <div class="eight wide field">
                      <div class="field">
                          <div class="field">
                              <label>Price:</label>
                              <div class="two fields">
                                  <div id="price-input" class="field">
                                      <input id="price" name="price" placeholder="Add price" type="text">
                                  </div>
                                  <div class="ui checkbox" style="margin-top:1%;">
                                      <input id="is-negociable-input" type="checkbox" name="negociable" onChange={setNegociable('is-negociable-input')} unchecked={}>
                                      <label>Negociable</label>
                                  </div>
                              </div>
                          </div>

                          <div class="field">
                              <label>Usable surface:</label>
                              <div class="two fields">
                                  <div id="usable-surface-input" class="field">
                                      <input id="usable-surface" name="usable_surface" placeholder="Add surface in square meters" type="text">
                                  </div>

                                  <div class="ui image label" style="background-color:#f1f1f2;">
                                      <h3>m<sup>2</sup></h3>
                                  </div>
                              </div>
                          </div>

                          <div class="eight wide field">
                              <label>Construction year:</label>
                                  <div id="construction-year-input">
                                      <input id="construction-year" name="construction_year" placeholder="Add year" type="number" min="1600" max="2017">
                                  </div>
                          </div>

                          <div class="eight wide field">
                              <label>Furniture/Utilities</label>
                              <div class=" field">
                                  <select id="furniture-utilities-select">
                                      <option value="" disabled selected>Choose</option>
                                      <option value="1">Complete</option>
                                      <option value="2">Partial</option>
                                      <option value="3">None</option>
                                  </select>
                              </div>
                          </div>
                      </div>

                  </div>
                  <div class="field">
                      <label>Property address: </label>

                      <style>
                        #map11 {
                          margin-top: 50%;
                          margin-left: 0%;
                          height: 75%;
                          width: 52%;
                          }
                        </style>
                       <div id="map11"></div>
                  </div>
              </div>

              <div class="field">
                  <label>Description</label>
                  <div id="description-textarea" class="ui form">
                      <textarea id="description" placeholder="Add a drescription here.." ></textarea>
                 </div>


              <h4 class="ui dividing header">Contact</h4>
              <div class="field">
                  <label>Contact name</label>
                  <div id="name-input" class="four wide field">
                      <input id="name" type="text" placeholder="Add name">
                  </div>
              </div>

              <div class="field">
                  <label>Email</label>
                  <div id="email-input" class="four wide field">
                      <input id="email" type="text" placeholder="Add email">
                  </div>
              </div>

              <div class="field">
                  <label>Phone number</label>
                  <div id="phone-number-input"class="four wide field">
                      <input id="phone-number" type="text" placeholder="Add phone number">
                  </div>
              </div>

              <div class="ui button" tabindex="0" value="Submit" onclick="addPropertyPOST()">Submit Order</div>
          </form>
</div>
      </div>
      <script>
      $('a').click(function(){
      $('html, body').animate({
          scrollTop: $( $(this).attr('href') ).offset().top
      }, 500);
      return false;
      });
      </script>

      <style>
    #map11 {
      margin-top: 0%;
      margin-left: 0%;
      height: 100%;
      width: 100%;
      }
    </style>
     <!-- <div id="map11"></div>-->

      <script>
        var globalMap11;

        var isForRent=0;
        var isForSale=0;
        var isNegociable=0;
        var addressLat=0;
        var addressLng=0;
        var markersArray = [];
        function initMap11() {
              var map11 = new google.maps.Map(document.getElementById('map11'), {
                zoom: 14,
                center: {lat:47,lng:27}
              });
              globalMap11 = map11;
              google.maps.event.addListener(globalMap11, 'click', function(event) {
                placeMarker(event.latLng);
                addressLat=event.latLng.lat();
                addressLng=event.latLng.lng();
                //console.log("coordinates: "+ event.latLng.lat() + ", " + event.latLng.lng());
              });
        }
        function placeMarker(location) {
            deleteOverlays();
            var marker = new google.maps.Marker({
                position: location,
                map: globalMap11
            });
            markersArray.push(marker);
        }
        function deleteOverlays() {
            if (markersArray) {
                for (i in markersArray) {
                    markersArray[i].setMap(null);
                }
            markersArray.length = 0;
            }
        }

        function addPropertyPOST() {

               console.log('addPropertyPOST');
               var method = "POST";
               var categoryInput = document.getElementById('category-select');
               var category = categoryInput.value;
               console.log(category);
               var roomsInput = document.getElementById('rooms-select');
               var rooms = roomsInput.value;
               console.log(rooms);
               console.log("rent: " + isForRent);
               console.log("sale: " + isForSale);
               var priceInput = document.getElementById('price');
               var price= priceInput.value;
               console.log("price: " + price);
               console.log("negociable: " + isNegociable);
               var surfaceInput = document.getElementById('usable-surface');
               var surface = surfaceInput.value;
               console.log("surface: " + surface);
               var yearInput = document.getElementById('construction-year');
               var year = yearInput.value;
               console.log("year:" + year);
               var furnitureInput = document.getElementById('furniture-utilities-select');
               var furniture = furnitureInput.value;
               console.log("furniture:" + furniture);
               var descriptionInput = document.getElementById('description');
               var description = descriptionInput.value;
               console.log("description:" + description);
               var nameInput = document.getElementById('name');
               var name = nameInput.value;
               console.log("name:" + name);
               var emailInput = document.getElementById('email');
               var email = emailInput.value;
               console.log("email:" + email);
               var phoneNumberInput = document.getElementById('phone-number');
               var phoneNumber = phoneNumberInput.value;
               console.log("phoneNumber:" + phoneNumber);
               console.log("lat:" + addressLat);
               console.log("lng:" + addressLng);
               /*
               var passInput = document.getElementById('passwordSignUp');
               var password = passInput.value;
               var emailInput = document.getElementById('email');
               var email = emailInput.value;
               var isValid = true;
               var atpos = email.indexOf("@");
               var dotpos = email.lastIndexOf(".");
              if (firstName === "") {
                     $('#first-name-input').addClass('error');
                     $('#first-name').attr("placeholder","Insert first name");
                     $('#errorMessage').text("Insert first name");
                     $('#errorMessageContainer').css("display", "block");
                     isValid = false;
               }
               if (lastName === "") {
                     $('#last-name-input').addClass('error');
                     $('#last-name').attr("placeholder","Insert last name");
                         $('#errorMessage').text("Insert last name");
                         $('#errorMessageContainer').css("display", "block");

                     isValid = false;
               }
               if (password === "") {
                     $('#password-input').addClass('error');
                     $('#passwordSignUp').attr("placeholder","Insert password");
                          $('#errorMessage').text("Insert password");
                          $('#errorMessageContainer').css("display", "block");

                     isValid = false;
               }
               if (email === "" || atpos<1 || dotpos<atpos+2 || dotpos+2>=email.length) {
                     $('#email-input').addClass('error');
                     $('#email').attr("placeholder","Insert email");
                         $('#errorMessage').text("Insert email");
                         $('#errorMessageContainer').css("display", "block");

                     isValid = false;
               }
               var postData = {
                   "first-name": firstName,
                    "last-name" : lastName,
                    "password" : password,
                    "email" : email

                   };
               if (isValid === true ){
                   var async = true;
                   var request = new XMLHttpRequest();
                   request.onload = function () {
                         var status = request.status; // HTTP response status, e.g., 200 for "200 OK"
                      var data = request.responseText; // Returned data, e.g., an HTML document.
                      console.log(data);
                   }

                   request.open(method, url,true);
                   request.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
                   if (request.status == 403) {
                         console.log ("DUPLICATE EMAIL");
                   } else {
                     document.getElementById('signupButton').style.display='none';
                     document.getElementById('signInStatus').style.display='block';
                   }
                   request.send(JSON.stringify(postData));
                   document.getElementById('signupButton').style.display='none';
                    $("#email").val("");
                    $("#passwordSignUp").val("");
                    $("#first-name").val("");
                    $("#last-name").val("");

               }
               */
        }

    </script>

      <script async defer
              src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAiF0Un_CZtZJXb_az1JsfXQaejuF6iCXk&libraries=places,visualization&callback=initMap11">
      </script>
  </div>
    </body>
  </html>
